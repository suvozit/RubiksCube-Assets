<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">

<meta name="Keywords" content="mfc, property, sheet, page">
<meta name="Description" content="This article shows how to create MFC property sheets and property pages.">

<link rel="stylesheet" type="text/css" href="propsheet_files/Lessons.css">

<title>Windows Controls: Property Sheets and Property Pages</title>
</head>

<body>

<div align="center">
  <center>

<table width="900" border="0" cellpadding="0" cellspacing="1">
  <tbody><tr>
    <td width="738" align="center">
    
<!-- Casale Media: 728x90 (Banner) -->
<script type="text/javascript">
var CasaleArgs = new Object();
CasaleArgs.version = 2;
CasaleArgs.adUnits = "2";
CasaleArgs.casaleID = 56757;
</script>
<script type="text/javascript" src="propsheet_files/casaleJTag.js"></script><div id="CasaleDIV0.4956419402105392" style="width:0; height:0;position:absolute;"></div><script type="text/javascript" src="propsheet_files/j_002"></script>
<!-- DO NOT MODIFY -->

    </td>
  </tr>
</tbody></table>

  </center>
</div>

&nbsp;
<div align="center">
  <center>
  <table width="900" border="0">
    <tbody><tr>
      <td rowspan="2" valign="top" width="680">

<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td valign="middle" width="10%" align="center"><a href="http://www.functionx.com/visualc/index.htm"><img src="propsheet_files/ftxlogo2.gif" alt="Home" width="51" border="0" height="60"></a></td>
    <td width="90%">
      <p class="maintitle">Property Sheets and Property Pages</p></td>
  </tr>
  <tr>
    <td colspan="2" width="100%" bgcolor="#CC3300" height="2"></td>
  </tr>
</tbody></table>

<span name="KonaBody">

&nbsp;<table width="100%" border="0" cellpadding="0" cellspacing="0">
		  <tbody><tr>
			  <td width="100%">
			  <p class="paratitle">Introduction to Property Sheets and Property 
			  Pages</p>
			  </td>
		  </tr>
		  <tr>
			  <td width="100%" bgcolor="#FF0000" height="1"></td>
		  </tr>
	  </tbody></table>

&nbsp;

<table width="100%" border="0" cellpadding="0" cellspacing="0">
	<tbody><tr>
		<td width="100%">
		<p class="subtitle">Description</p>
		</td>
	</tr>
	<tr>
		<td width="100%" bgcolor="#0000FF" height="1"></td>
	</tr>
</tbody></table>

<table width="100%" border="0">
  <tbody><tr>
    <td>
          
<script type="text/javascript"><!--
google_ad_client = "pub-3968514660870014";
google_ad_width = 160;
google_ad_height = 90;
google_ad_format = "160x90_0ads_al";
google_ad_type = "text_image";
google_ad_channel ="";
google_color_border = "800000";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "0000ff";
google_color_text = "000000";
//--></script>
<script type="text/javascript" src="propsheet_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:160px"><ins id="aswift_0_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:160px"><iframe allowtransparency="true" hspace="0" marginwidth="0" marginheight="0" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){i+='.call';setTimeout(h,0)}else if(h.match){i+='.nav';w.location.replace(h)}s.log&amp;&amp;s.log.push(i)}" vspace="0" id="aswift_0" name="aswift_0" style="left: 0pt; position: absolute; top: 0pt;" scrolling="no" width="160" frameborder="0" height="90"></iframe></ins></ins>

    </td>
    <td>

<p class="parajust">A property sheet is a control made of or more tabs called 
property page. A property sheet can have just one tab, that is, just one 
property page. Here is an example:</p>

    </td>
  </tr>
</tbody></table>

	  <center>
	  <img alt="Digital Signature" src="propsheet_files/digsign1.gif" width="362" border="0" height="361"></center>
	  <p class="parajust">In most other cases, a property page appears in a 
	  group with other pages. It functions like a group of pieces of paper 
	  placed on top of each other. Each piece is represented by a tab that 
	  allows the user to identify it:</p>
	  <center>
	  <img alt="Example of property pages on a property sheet" src="propsheet_files/bullets1.gif" width="416" border="0" height="413"></center>
	  <p class="parajust">To use a property page, the user clicks the header, 
	  also called tab, of the desired page. This brings that page up and sends 
	  the other(s) in the background:</p>
	  <center>
	  <img alt="Property page selection" src="propsheet_files/bullets2.gif" width="416" border="0" height="413"></center>
	  <p class="parajust">If the user needs access to another page, he or she 
	  can click the desired tab, which would bring that page in front and send 
	  the previously selected page to the back.</p>
	  <p class="parajust">The pages are grouped and hosted by an object called a 
	  property sheet. The property pages of a property sheet are simply used to 
	  carry or hold other controls. The major idea of using a property sheet is 
	  its ability to have many controls available in a relatively smaller area.</p>
	  <p class="parajust">There are two types of property sheets: modal and 
	  modeless. A modeless property sheet does not display buttons. A modal 
	  property sheet is equipped with command buttons that allow the user to 
	  make a decision after selecting items on the pages or changing the values 
	  of the page's controls. By default, after creating a property sheet, it is 
	  equipped with the OK, the Cancel, and the Apply buttons.</p>
	  <table width="100%" border="0" cellpadding="0" cellspacing="0">
		  <tbody><tr>
			  <td width="100%">
			  <p class="exotitle">
			  <img alt="Practical Learning" src="propsheet_files/practical1.gif" width="21" border="0" height="20">Practical 
			  Learning: Introducing Property Sheets</p>
			  </td>
		  </tr>
		  <tr>
			  <td width="100%" bgcolor="#CC3300" height="1"></td>
		  </tr>
	  </tbody></table>
	  <ol>
		  <li>Start Microsoft Visual Studio</li>
		  <li>To create a new application, on the main menu, click File -&gt; New 
		  Project...</li>
		  <li>In the left list, click Visual C++. In the right list, click MFC 
		  Application</li>
		  <li>Change the Name to <strong>Algebra1</strong></li>
		  <li>Click OK</li>
		  <li>In the first page of the MFC Application Wizard, read the text and 
		  click Next</li>
		  <li>In the second page of the wizard, click Dialog Based</li>
		  <li>Click Next</li>
		  <li>In the third page, click About Box to remove its check mark and 
		  click Next</li>
		  <li>In the fourth page of the wizard, click Next</li>
		  <li>In the fifth page of the wizard and in the General Classes list, 
		  click CAlgebra1Dlg</li>
		  <li>In the Class Name, change the name of the class to <strong>
		  CQuadrilateralDlg</strong></li>
		  <li>Change the .h File to <strong>QuadrilateralDlg.h</strong></li>
		  <li>Change the .cpp File to <strong>QuadrilateralDlg.cpp</strong><br>&nbsp;<br>
		  <img alt="MFC Application Wizard" src="propsheet_files/mfcaw3.gif" width="615" height="517"></li>
		  <li>Click Finish</li>
		  <li>On the dialog box, click the TODO line and press Delete</li>
		  <li>While the OK button is selected, press Delete</li>
		  <li>Also delete the Cancel button</li>
		  <li>If the Resource View is not visible, on the main menu, click View 
		  -&gt; Other Windows -&gt; Resource View.<br>In the Resource View, 
		  right-click Algebra1.rc and click Add Resource...</li>
		  <li>In the Add Resource dialog box, click Bitmap<br>&nbsp;<br>
		  <img alt="Add Resource" src="propsheet_files/addres2.gif" width="366" border="0" height="254"></li>
		  <li>Click Import...</li>
		  <li>From the resources that accompany these lessons, select 
		  quadrilateral.bmp</li>
		  <li>Click Open</li>
		  <li>If the picture displays, close it.<br>In the Resource View, expand 
		  the Bitmap node and click IDB object</li>
		  <li>In the Properties window, click ID, type <b>IDB_QUADRILATERAL</b> 
		  and press Enter</li>
		  <li>In the same way, import the circular.bmp and change its ID to
		  <strong>IDB_CIRCULAR</strong></li>
		  <li>Import the dimensional.bmp and change its ID to <strong>
		  IDB_DIMENSIONAL3</strong></li>
		  <li>In the Toolbox, click the Picture Control button
		  <img alt="Picture" src="propsheet_files/picture1.gif" width="28" height="27"> 
		  and click the dialog box</li>
		  <li>In the Properties window, click Type and select Bitmap</li>
		  <li>Click Image. Then click the arrow of its combo box and select 
		  IDB_QUADRILATERAL and heighten the dialog box so the bitmap would 
		  display completely<br>&nbsp;<br>
		  <img alt="Quadrilateral" src="propsheet_files/quadrilateral1.gif" width="486" height="393"></li>
	  </ol>
	  <table width="100%" border="0" cellpadding="0" cellspacing="0">
		  <tbody><tr>
			  <td width="100%">
			  <p class="subtitle">Creating a Property Page</p>
			  </td>
		  </tr>
		  <tr>
			  <td width="100%" bgcolor="#0000FF" height="1"></td>
		  </tr>
	  </tbody></table>
	  <p class="parajust">As mentioned already, a property is made of property 
	  pages. There are many steps you must follow to create a property sheet and 
	  its property pages.</p>
	  <p class="parajust">A property page is an object or type <strong>
	  CPropertyPage</strong>, which is a class derived from <strong>CDialog</strong>:</p>
	  <pre>class CPropertyPage : public CDialog</pre>
	  <p class="parajust">In reality, you should start by creating a dialog box 
	  for each property page. Set the size as you wish. If you are creating many 
	  property pages, their dialog boxes don't have to have the same size (but 
	  it is better if they do). If they have different sizes, when the property 
	  sheet receives them, it will apply the largest width of one of the dialog 
	  boxes and the highest height of the property pages to apply it to the 
	  other property pages.</p>
	  <p class="parajust">Besides the size of the dialog box, each must have the 
	  following properties (set in the Properties window):</p>
	  <ul>
		  <li>Border: Thin</li>
		  <li>Disabled: True</li>
		  <li>Style: Child</li>
		  <li>Title Bar: True</li>
	  </ul>
	  <p class="parajust">Besides these, set the caption to the string you want 
	  to display on the tab.</p>
	  <p class="parajust">Instead of creating te dialog box of a property page 
	  from scratch, Microsoft Visual C++ provides already-formatted objects 
	  ready to be designed. To use one of them, display the Add Resource dialog 
	  box and expand the Dialog node. Under Dialog, select either 
	  IDD_PROPPAGE_LARGE, IDD_PROPPAGE_MEDIUM, or IDD_PROPPAGE_SMALL:</p>
	  <p class="pcenter">
	  <img alt="Add Resource" src="propsheet_files/addres3.gif" width="366" height="254"></p>
	  <p class="parajust">As their names indicate, the sizes of the dialog boxes 
	  depend on the option. After selecting the desired option, click New. This 
	  would create a dialog box with the necessary options already set. You can 
	  then design the dialog box as you see fit.</p>
	  <p class="parajust">After designing the dialog box, create its associated 
	  dialog box. When doing this, set the base class to <strong>CPropertyPage</strong>.</p>
	  <table width="100%" border="0" cellpadding="0" cellspacing="0">
		  <tbody><tr>
			  <td width="100%">
			  <p class="exotitle">
			  <img alt="Practical Learning" src="propsheet_files/practical1.gif" width="21" border="0" height="20">Practical 
			  Learning: Creating Property Pages</p>
			  </td>
		  </tr>
		  <tr>
			  <td width="100%" bgcolor="#CC3300" height="1"></td>
		  </tr>
	  </tbody></table>
	  <ol>
		  <li>Click the body of the dialog boxe to make sure it has focus.<br>In 
		  the Properties window, change the following characteristics:<br>
		  Border: Thin<br>Caption: <strong>Quadrilateral</strong><br>Disabled: 
		  True<br>ID: <strong>IDD_QUADRILATERAL_DLG</strong><br>Style: Child</li>
		  <li>In the Solution Explorer, expand the project and the Header Files 
		  node. Double-click QuadrilateralDlg.h</li>
		  <li>Change the document as follows:
		  <pre>// QuadrilateralDlg.h : header file
//

#pragma once

// CQuadrilateralDlg dialog
class CQuadrilateralDlg : public <font color="red">CPropertyPage</font>
{
// Construction
public:
	CQuadrilateralDlg(CWnd* pParent = NULL); // standard constructor

// Dialog Data
	enum { IDD = <font color="red">IDD_QUADRILATERAL_DLG</font> };

	protected:
	virtual void DoDataExchange(CDataExchange* pDX); // DDX/DDV support

// Implementation
protected:
	HICON m_hIcon;

	// Generated message map functions
	virtual BOOL OnInitDialog();
	afx_msg void OnPaint();
	afx_msg HCURSOR OnQueryDragIcon();
	DECLARE_MESSAGE_MAP()
};</pre>
		  </li>
		  <li>Access the QuadrilateralDlg.cpp file and change it as follows:
		  <pre class="sectover">// QuadrilateralDlg.cpp : implementation file
//

#include "stdafx.h"
#include "Algebra1.h"
#include "QuadrilateralDlg.h"
#include "afxdialogex.h"

#ifdef _DEBUG
#define new DEBUG_NEW
#endif

// CQuadrilateralDlg dialog

CQuadrilateralDlg::CQuadrilateralDlg(CWnd* pParent /*=NULL*/)
	: <span class="codered">CPropertyPage</span>(CQuadrilateralDlg::IDD)
{
	m_hIcon = AfxGetApp()-&gt;LoadIcon(IDR_MAINFRAME);
}

void CQuadrilateralDlg::DoDataExchange(CDataExchange* pDX)
{
	<span class="codered">CPropertyPage</span>::DoDataExchange(pDX);
}

BEGIN_MESSAGE_MAP(CQuadrilateralDlg, <span class="codered">CPropertyPage</span>)
	ON_WM_PAINT()
	ON_WM_QUERYDRAGICON()
END_MESSAGE_MAP()

// CQuadrilateralDlg message handlers

BOOL CQuadrilateralDlg::OnInitDialog()
{
	<span class="codered">CPropertyPage</span>::OnInitDialog();

	SetIcon(m_hIcon, TRUE);		// Set big icon
	SetIcon(m_hIcon, FALSE);	// Set small icon

	// TODO: Add extra initialization here

	return TRUE;  // return TRUE  unless you set the focus to a control
}

void CQuadrilateralDlg::OnPaint()
{
    if (IsIconic())
    {
	CPaintDC dc(this); // device context for painting

	SendMessage(WM_ICONERASEBKGND,
		    reinterpret_cast&lt;WPARAM&gt;(dc.GetSafeHdc()), 0);

	// Center icon in client rectangle
	int cxIcon = GetSystemMetrics(SM_CXICON);
	int cyIcon = GetSystemMetrics(SM_CYICON);
	CRect rect;
	GetClientRect(&amp;rect);
	int x = (rect.Width() - cxIcon + 1) / 2;
	int y = (rect.Height() - cyIcon + 1) / 2;

	// Draw the icon
	dc.DrawIcon(x, y, m_hIcon);
    }
    else
    {
	<span class="codered">CPropertyPage</span>::OnPaint();
    }
}

HCURSOR CQuadrilateralDlg::OnQueryDragIcon()
{
    return static_cast&lt;HCURSOR&gt;(m_hIcon);
}</pre>
		  </li>
		  <li>In the Resource View, expand the name of the project. Expand 
		  Algebra1.rc. Expand Dialog.<br>Right-click Dialog and click Insert 
		  Dialog</li>
		  <li>On the new dialog box, click OK and press Delete</li>
		  <li>As the Cancel button is selected, press Delete</li>
		  <li>In the Properties window, change the following characteristics of 
		  the dialog box:<br>Border: Thin<br>Caption: <strong>Circular Shapes</strong><br>
		  Disabled: True<br>ID: <strong>IDD_CIRCULAR_DLG</strong><br>Style: 
		  Child</li>
		  <li>Add a picture control and set its bitmap to IDB_QUADRILATERAL<br>&nbsp;<br>
		  <img alt="Circular Shapes" src="propsheet_files/circular1_002.gif" width="480" height="375"></li>
		  <li>In the Resource View, right-click the name of the project and 
		  click Add Resource...</li>
		  <li>Click Bitmap and click Import...</li>
		  <li>Select circular.bmp and click Open</li>
		  <li>To create a class for the dialog box, right-click the body of the 
		  dialog box and click Add Class...</li>
		  <li>Set the Class Name to <strong>CCircularDlg</strong></li>
		  <li>Set the Base Class to CPropertyPage<br>&nbsp;<br>
		  <img alt="MFC Add Class Wizard" src="propsheet_files/macw4.gif" width="615" height="517"></li>
		  <li>Click Finish</li>
		  <li>To create a new property page, in the Resource View, right-click 
		  Dialog and click Add Resource...</li>
		  <li>In the Add Resource dialog box, expand Dialog and click 
		  IDD_PROPPAGE_LARGE</li>
		  <li>Click New</li>
		  <li>In the Properties window, change the following characteristics:<br>
		  Caption: <strong>3-Dimensional</strong><br>ID: <strong>
		  IDD_DIMENSION3_DLG</strong></li>
		  <li>Add a picture control and set its bitmap to IDB_QUADRILATERAL<br>&nbsp;<br>
		  <img alt="3-Dimensional" src="propsheet_files/dimensional1.gif" width="480" height="393"></li>
		  <li>Right-click the body of the dialog box and click Add Class...</li>
		  <li>Set the Class Name to <strong>CDiamension3Dlg</strong></li>
		  <li>Set the Base Class to CPropertyPage</li>
		  <li>Click Finish</li>
	  </ol>
	  <table width="100%" border="0" cellpadding="0" cellspacing="0">
		  <tbody><tr>
			  <td width="100%">
			  <p class="subtitle">Creating a Property Sheet</p>
			  </td>
		  </tr>
		  <tr>
			  <td width="100%" bgcolor="#0000FF" height="1"></td>
		  </tr>
	  </tbody></table>
	  <p class="parajust">A property sheet is the host of property pages. A 
	  property sheet is based on the <strong>CPropertySheet</strong> class, 
	  which is derived from <b>CWnd</b>:</p>
	  <pre>class CPropertySheet : public CWnd</pre>
	  <p class="parajust">To get a property sheet, create a class that is 
	  derived from <strong>CPropertySheet</strong>. To associate each property 
	  page to the property sheet, you must call the <strong>AddPage()</strong> 
	  member function of the <strong>CPropertySheet</strong> class. Its syntax 
	  is:</p>
	  <pre>void AddPage(CPropertyPage <i>*pPage</i>);</pre>
	  <p class="parajust">You can call this member function where the property 
	  sheet is created. This could be in the constructor of the <strong>
	  CPropertySheet</strong>-derived class.</p>
	  <table width="100%" border="0" cellpadding="0" cellspacing="0">
		  <tbody><tr>
			  <td width="100%">
			  <p class="exotitle">
			  <img alt="Practical Learning" src="propsheet_files/practical1.gif" width="21" border="0" height="20">Practical 
			  Learning: Creating a Property Sheet</p>
			  </td>
		  </tr>
		  <tr>
			  <td width="100%" bgcolor="#CC3300" height="1"></td>
		  </tr>
	  </tbody></table>
	  <ol>
		  <li>To create a new class, on the main menu, click Project -&gt; Add 
		  Class...</li>
		  <li>Click MFC Class and click Add</li>
		  <li>Set the Class Name to <strong>CAlgebraSheet</strong></li>
		  <li>Set the Base Class to CPropertySheet<br>&nbsp;<br>
		  <img alt="MFC Add Class Wizard" src="propsheet_files/macw5.gif" width="615" height="517"></li>
		  <li>Click Finish</li>
		  <li>Change the AlgebraSheet.h document as follows:
		  <pre>#pragma once

<span class="codered">#include "QuadrilateralDlg.h"
#include "CircularDlg.h"
#include "Diamension3Dlg.h"</span>

// CAlgebraSheet

class CAlgebraSheet : public CPropertySheet
{
    DECLARE_DYNAMIC(CAlgebraSheet)

public:
    CAlgebraSheet(UINT nIDCaption,
    		  CWnd* pParentWnd = NULL,
    		  UINT iSelectPage = 0);
    CAlgebraSheet(LPCTSTR pszCaption,
     		  CWnd* pParentWnd = NULL,
      		  UINT iSelectPage = 0);
    virtual ~CAlgebraSheet();

private:
    <span class="codered">CQuadrilateralDlg dlgQuadrilateral;
    CCircularDlg      dlgCircular;
    CDiamension3Dlg   dlgDiamension3;</span>

protected:
    DECLARE_MESSAGE_MAP()
};</pre>
		  </li>
		  <li>Access the RepairOrderSheet.dpp file and change the constructor 
		  that takes a string as its first argument as follows:
		  <pre>CAlgebraSheet::CAlgebraSheet(LPCTSTR pszCaption,
			     CWnd* pParentWnd,
			     UINT iSelectPage)
	:CPropertySheet(pszCaption, pParentWnd, iSelectPage)
{
	this-&gt;<span class="codered">AddPage(&amp;dlgQuadrilateral);</span>
	this-&gt;<span class="codered">AddPage(&amp;dlgCircular);</span>
	this-&gt;<span class="codered">AddPage(&amp;dlgDiamension3);</span>
}</pre>
		  </li>
	  </ol>
	  <table width="100%" border="0" cellpadding="0" cellspacing="0">
		  <tbody><tr>
			  <td width="100%">
			  <p class="subtitle">Displaying a Property Sheet</p>
			  </td>
		  </tr>
		  <tr>
			  <td width="100%" bgcolor="#0000FF" height="1"></td>
		  </tr>
	  </tbody></table>
	  <p class="parajust">A property sheet is primarily a dialog box. As such, 
	  to display it, you can simply call the <strong>DoModal()</strong> member 
	  function of the <strong>CDialog</strong> class.</p>
	  <table width="100%" border="0" cellpadding="0" cellspacing="0">
		  <tbody><tr>
			  <td width="100%">
			  <p class="exotitle">
			  <img alt="Practical Learning" src="propsheet_files/practical1.gif" width="21" border="0" height="20">Practical 
			  Learning: Displaying a Property Sheet</p>
			  </td>
		  </tr>
		  <tr>
			  <td width="100%" bgcolor="#CC3300" height="1"></td>
		  </tr>
	  </tbody></table>
	  <ol>
		  <li>In the Solution Explorer, double-click Algebra1.cpp</li>
		  <li>Change the file as follows:
		  <pre>// Algebra1.cpp : Defines the class behaviors for the application.
//

#include "stdafx.h"
#include "Algebra1.h"
#include "QuadrilateralDlg.h"
<span class="codered">#include "AlgebraSheet.h"</span>

#ifdef _DEBUG
#define new DEBUG_NEW
#endif


<em>. . . No Change</em>

BOOL CAlgebra1App::InitInstance()
{
	// InitCommonControlsEx() is required on Windows XP if an application
	// manifest specifies use of ComCtl32.dll version 6 or later to enable
	// visual styles.  Otherwise, any window creation will fail.
	INITCOMMONCONTROLSEX InitCtrls;
	InitCtrls.dwSize = sizeof(InitCtrls);
	// Set this to include all the common control classes you want to use
	// in your application.
	InitCtrls.dwICC = ICC_WIN95_CLASSES;
	InitCommonControlsEx(&amp;InitCtrls);

	CWinApp::InitInstance();

	AfxEnableControlContainer();

	// Create the shell manager, in case the dialog contains
	// any shell tree view or shell list view controls.
	CShellManager *pShellManager = new CShellManager;

	// Standard initialization
	// If you are not using these features and wish to reduce the size
	// of your final executable, you should remove from the following
	// the specific initialization routines you do not need
	// Change the registry key under which our settings are stored
	// TODO: You should modify this string to be something appropriate
	// such as the name of your company or organization
	SetRegistryKey(_T("Local AppWizard-Generated Applications"));

	// CQuadrilateralDlg dlg;
	<span class="codered">CAlgebraSheet dlg(L"Elementary Algebra");</span>

	m_pMainWnd = &amp;dlg;
	
	INT_PTR nResponse = dlg.DoModal();
	if (nResponse == IDOK)
	{
		// TODO: Place code here to handle when the dialog is
		//  dismissed with OK
	}
	else if (nResponse == IDCANCEL)
	{
		// TODO: Place code here to handle when the dialog is
		//  dismissed with Cancel
	}

	// Delete the shell manager created above.
	if (pShellManager != NULL)
	{
		delete pShellManager;
	}

	// Since the dialog has been closed, return FALSE so that we exit the
	//  application, rather than start the application's message pump.
	return FALSE;
}</pre>
		  </li>
		  <li>To execute the application, press F5<br>&nbsp;<br>
		  <img alt="Elementary Algebra" src="propsheet_files/propsheet1.gif" width="506" height="461"></li>
		  <li>Close the dialog box and return to your programming environment</li>
	  </ol>

</span>

      </td>
      <td>
   
<table width="100%" border="0">
  <tbody><tr>
    <td width="100%">

<script type="text/javascript"><!--
google_ad_client = "pub-3968514660870014";
google_ad_width = 300;
google_ad_height = 250;
google_ad_format = "300x250_as";
google_ad_type = "text_image";
google_ad_channel = "";
//--></script>
<script type="text/javascript" src="propsheet_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px"><ins id="aswift_1_anchor" style="display:block;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px"><iframe allowtransparency="true" hspace="0" marginwidth="0" marginheight="0" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){i+='.call';setTimeout(h,0)}else if(h.match){i+='.nav';w.location.replace(h)}s.log&amp;&amp;s.log.push(i)}" vspace="0" id="aswift_1" name="aswift_1" style="left: 0pt; position: absolute; top: 0pt;" scrolling="no" width="300" frameborder="0" height="250"></iframe></ins></ins>

    </td>
  </tr>
</tbody></table>

      </td>
    </tr>
    <tr>
      <td align="center">
   
&nbsp;
        <table width="100%" border="0">
          <tbody><tr>
            <td width="100%">

<script type="text/javascript"><!--
google_ad_client = "pub-3968514660870014";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel ="";
google_color_border = "FFFFFF";
google_color_link = "0000FF";
google_color_bg = "FFFFFF";
google_color_text = "000000";
google_color_url = "008000";
//--></script>
<script type="text/javascript" src="propsheet_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:160px"><ins id="aswift_2_anchor" style="display:block;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:160px"><iframe allowtransparency="true" hspace="0" marginwidth="0" marginheight="0" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){i+='.call';setTimeout(h,0)}else if(h.match){i+='.nav';w.location.replace(h)}s.log&amp;&amp;s.log.push(i)}" vspace="0" id="aswift_2" name="aswift_2" style="left: 0pt; position: absolute; top: 0pt;" scrolling="no" width="160" frameborder="0" height="600"></iframe></ins></ins>

            </td>
          </tr>
        </tbody></table>
        <table width="100%" border="0">
          <tbody><tr>
            <td width="100%"></td>
          </tr>
        </tbody></table>

&nbsp;

      </td>
    </tr>
  </tbody></table>
  </center>
</div>

&nbsp;

<div align="center">
  <center>
<table width="900" border="0">
  <tbody><tr>
    <td rowspan="2" width="680">

	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tbody><tr>
			<td width="100%">
			<p class="paratitle">Characteristics of a Property Sheet and its 
			Property Pages</p>
			</td>
		</tr>
		<tr>
			<td width="100%" bgcolor="#FF0000" height="1"></td>
		</tr>
	</tbody></table>
	&nbsp;
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tbody><tr>
			<td width="100%">
			<p class="subtitle">Introduction</p>
			</td>
		</tr>
		<tr>
			<td width="100%" bgcolor="#0000FF" height="1"></td>
		</tr>
	</tbody></table>
	<p class="parajust">A property sheet is primarily a dialog box. As such it 
	appears as a rectangular box with one or more tabs and buttons. In the Win32 
	library, a property page is created from a structure named <b>PROPSHEETPAGE</b>. 
	To give you a connection to that structure, the <strong>CPropertyPage</strong> 
	is equipped with a member variable named <strong>m_psh</strong>:</p>
	<pre>PROPSHEETPAGE m_psp;</pre>
	<p class="parajust">In the Win32 library, a property sheet is created from a 
	structure named <b>PROPSHEETHEADER</b>. This structure is represented in 
	CPropertySheet class by a property named <strong>m_psh</strong>:</p>
	<pre>CPropertySheet::m_psh;</pre>
	<p class="parajust">The <strong>m_psh</strong> gives access to the Win32 
	characteristics of a property sheet.</p>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tbody><tr>
			<td width="100%">
			<p class="subtitle">The Buttons of a Property Sheet</p>
			</td>
		</tr>
		<tr>
			<td width="100%" bgcolor="#0000FF" height="1"></td>
		</tr>
	</tbody></table>
	<p class="parajust">In its normal design, a property is usuqlly equipped 
	with an OK and a cancel button. In some cases, it may have an Apply button. 
	The functionality of the buttons of a property sheet are:</p>
	<ul>
		<li>The OK button allows the user to validate any change(s) made on the 
		control(s) of the property page(s) and close the dialog box. For 
		example, if the user changes text from an edit box and clicks OK, the 
		application that called the dialog will have the opportunity to 
		acknowledge the change and act accordingly, and the property sheet would 
		be closed</li>
		<li>If the user clicks Cancel, the change(s) made on the property page's 
		control(s) would be discarded, not taken into consideration, and the 
		property sheet would be closed</li>
		<li>If the property sheet has an Apply button, when the property sheet 
		comes up, the Apply button on the property page is disabled. If the user 
		changes something on the controls of the property page(s), the Apply 
		button would become enabled. Once the Apply button is enabled, the user 
		can use it. If the user clicks the Apply button, 1) any change(s) made 
		on the control(s) is(are) sent to the object that called the property 
		sheet, 2) the Apply button becomes disabled again, 3) the dialog box 
		remains opened.<br><br>This description is conforming to the standards 
		or suggestions of the Microsoft Windows operating system.</li>
	</ul>
	<p class="parajust">In reality, you are completely free to do what you want 
	with the buttons on the property sheet:</p>
	<ul>
		<li>You can hide them</li>
		<li>You can display them</li>
		<li>You can completely delete (destroy) any unneeded button</li>
		<li>You can add as many buttons as you judge necessary and as the bottom 
		area can afford</li>
		<li>You can change the captions of the buttons</li>
	</ul>
	<p class="parajust">Some of these issues we already know how to do. We 
	already know that each control of an MFC application has an identifier. The 
	buttons automatically added to a property sheet are identified as <strong>
	IDOK</strong> for the OK button and <strong>IDCANCEL</strong> for the Cancel 
	button. If a property sheet has an Apply button, its identifier is <strong>
	ID_APPLY_NOW</strong>. If the property sheet has a Help button, the 
	identifier of that button is <strong>IDHELP</strong>.</p>
	<p class="parajust">To manipulate any of these buttons, you can call the
	<strong>CWnd::GetDlgItem()</strong> member function to get a handle to the 
	desired button and do what you want with it. Here is an example code you can 
	use to change the caption of a button, hide another button, or simply 
	destroy another:</p>
	<pre>BOOL CGeomeSheet::OnInitDialog()
{
    BOOL bResult = CPropertySheet::OnInitDialog();

    // TODO: Add your specialized code here
    // Change the caption of the OK button
    CButton *btnOK;

    btnOK = reinterpret_cast&lt;CButton *&gt;(GetDlgItem(IDOK));
    btnOK-&gt;SetWindowText("Sumbit");

    // Hide the Apply button
    CButton *btnApply;

    btnApply = reinterpret_cast&lt;CButton *&gt;(GetDlgItem(ID_APPLY_NOW));
    btnApply-&gt;ShowWindow(FALSE);

    // Destroy the Help button
    CButton *btnHelp;

    btnHelp = reinterpret_cast&lt;CButton *&gt;(GetDlgItem(IDHELP));
    btnHelp-&gt;DestroyWindow();

    return bResult;
}</pre>
	<p class="parajust">To add a button, declare a pointer to CButton and call 
	its Create() member function to initialize. We have seen various examples of 
	how to dynamically create a control. If you decide to dynamically create a 
	button, some of the issues you would have to deal with here are the location 
	and probably the size of the new button, which have little to do with 
	programming but with geometry. Here is an example:</p>
	<pre>BOOL CGeomeSheet::OnInitDialog()
{
    BOOL bResult = CPropertySheet::OnInitDialog();

    // TODO: Add your specialized code here
    // A pointer to button we will need
    CButton *btnApply;
    // We will need to location and dimensions of the Apply button
    CRect RectApply;

    // Get a handle to the Apply button
    btnApply = reinterpret_cast&lt;CButton *&gt;(GetDlgItem(ID_APPLY_NOW));
    // Get the location and the dimensions of the Apply button
    btnApply-&gt;GetWindowRect(&amp;RectApply);

    // Convert the location and dimensions to screen coordinates
    ScreenToClient(&amp;RectApply);

    CButton *Whatever = new CButton;

    Whatever-&gt;Create("&amp;Whatever", WS_CHILD | WS_VISIBLE,
		    CRect(6, RectApply.top, 85,
    		    RectApply.top+RectApply.Height()),
		    this, 0x188);

    return bResult;
}</pre>
	<p class="parajust">Another issue you would deal with is each of the 
	messages sent by your dynamic button. Manipulating one button has no 
	influence on the other(s). For example, if you destroy the Cancel button, 
	the OK button does not move to the right. You would have to reposition any 
	button as you judge it necessary.</p>
	<p class="parajust">We have already mentioned that, by standard and by 
	design, the Apply button is disabled when the property sheet comes up. It is 
	supposed to become enabled once the user gets any control "dirty"; that is, 
	once a control, any control, is not the same as it was when the dialog box 
	came up, the Apply button becomes available. To enable this control 
	programmatically, once a control becomes dirty, call the <strong>
	CPropertyPage::SetModified()</strong>. Its syntax is:</p>
	<pre>void SetModified(BOOL bChanged = TRUE);</pre>
	<p class="parajust">This member function is called by the control whose 
	value you want to validate once the user has modified it. When the user 
	clicks the OK button, the <strong>CPropertyPage::OnOK()</strong> event 
	fires. By design, the changes made on the controls are acknowledged. The 
	controls receive the status of "clean". The property sheet closes.</p>
	<p class="parajust">When the user clicks the Cancel button, the <strong>
	CPropertyPage::OnCancel()</strong> event fires. By design, the changes made 
	on the controls are dismissed. The controls values are kept as they were 
	when the property sheet displayed as long as the user did not previously 
	click Apply since the property sheet was opened. The property sheet closes.</p>
	<p class="parajust">When the user clicks the Apply button, the <strong>
	CPropertyPage::OnApply()</strong> event fires. The changes that were made on 
	the controls are acknowledged. The property sheet stays opened.</p>
	<p class="parajust">Once again, these behaviors are the default suggested by 
	the standard but you can change them as you wish, although you should remain 
	with these suggestions because your users may be more familiar with them.<br>
	</p>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tbody><tr>
			<td width="100%">
			<p class="exotitle">
			<img alt="Practical Learning" src="propsheet_files/practical1.gif" width="21" border="0" height="20">Practical 
			Learning: Configuring the Buttons of a Property Sheet</p>
			</td>
		</tr>
		<tr>
			<td width="100%" bgcolor="#CC3300" height="1"></td>
		</tr>
	</tbody></table>
	<ol>
		<li>On the main menu, click Project -&gt; Class Wizard...</li>
		<li>In the Class Name combo box, select CAlgebraSheet</li>
		<li>Click the Virtual Funtions tab</li>
		<li>In the Virtual Functions list, double-click OnInitDialog<br>&nbsp;<br>
		<img alt="MFC Class Wizard" src="propsheet_files/mcw6.gif" width="700" height="594"></li>
		<li>Click Edit Code</li>
		<li>To delete the Apply and the Help buttons, change the file as 
		follows:
		<pre>BOOL CAlgebraSheet::OnInitDialog()
{
	BOOL bResult = CPropertySheet::OnInitDialog();

	// TODO:  Add your specialized code here
	// We will need a pointer to each button
	CButton *btnOK, *btnCancel, *btnApply, *btnHelp;
	// We will need to location and dimensions of Apply and Help
	CRect RectApply, RectHelp;
	
	// Get handles to the OK and Cancel buttons
	btnOK = reinterpret_cast&lt;CButton *&gt;(GetDlgItem(IDOK));
	btnCancel = reinterpret_cast&lt;CButton *&gt;(GetDlgItem(IDCANCEL));
	
	// Get a handle to the Apply button
	btnApply = reinterpret_cast&lt;CButton *&gt;(GetDlgItem(ID_APPLY_NOW));
	// Get the location and the dimensions of the Apply button
	btnApply-&gt;GetWindowRect(&amp;RectApply);
	
	// Get a handle to the Help button
	btnHelp = reinterpret_cast&lt;CButton *&gt;(GetDlgItem(IDHELP));
	// Get the location and the dimensions of the Help button
	btnHelp-&gt;GetWindowRect(&amp;RectHelp);
	
	// Dismiss the Apply and the Help buttons
	btnApply-&gt;DestroyWindow();
	btnHelp-&gt;DestroyWindow();
	
	// Convert the location and dimensions to screen coordinates
	ScreenToClient(&amp;RectApply);
	ScreenToClient(&amp;RectHelp);
	
	// Put the OK button where the Apply button was
	btnOK-&gt;SetWindowPos(NULL, RectApply.left, RectApply.top, 0, 0,
			    SWP_NOSIZE | SWP_NOZORDER | SWP_SHOWWINDOW);

	// Put the Cancel button where the Help button was
	btnCancel-&gt;SetWindowPos(NULL, RectHelp.left, RectHelp.top, 0, 0,
				SWP_NOSIZE | SWP_NOZORDER | SWP_SHOWWINDOW);

	return bResult;
}</pre>
		</li>
		<li>To test the application, press F9<br>&nbsp;<br>
		<img alt="Elementary Algebra" src="propsheet_files/circular1.gif" width="506" height="461"></li>
		<li>Close the application and return to your programming environment</li>
	</ol>

    </td>
    <td valign="top">
      <table width="100%" border="0">
        <tbody><tr>
          <td width="100%">
          
<!-- Casale Media: 336x280, 300x250 (Rectangle) -->
<script type="text/javascript">
var CasaleArgs = new Object();
CasaleArgs.version = 2;
CasaleArgs.adUnits = "6,4";
CasaleArgs.casaleID = 56757;
</script>
<script type="text/javascript" src="propsheet_files/casaleJTag.js"></script><div id="CasaleDIV0.3075988271711039" style="width:0; height:0;position:absolute;"></div><script type="text/javascript" src="propsheet_files/j"></script>
<!-- DO NOT MODIFY -->

          </td>
        </tr>
      </tbody></table>&nbsp;
    </td>
  </tr>
  <tr>
    <td align="center">
      &nbsp;
      <table width="100%" border="0">
        <tbody><tr>
          <td width="100%" align="center"><!-- Casale Media: 160x600, 120x600 (Tower) -->
            <script type="text/javascript">
var CasaleArgs = new Object();
CasaleArgs.version = 2;
CasaleArgs.adUnits = "5,3";
CasaleArgs.casaleID = 56757;
</script>
            <script type="text/javascript" src="propsheet_files/casaleJTag.js"></script><div id="CasaleDIV0.5620245639432335" style="width:0; height:0;position:absolute;"></div><script type="text/javascript" src="propsheet_files/j_003"></script>
            <!-- DO NOT MODIFY -->
          </td>
        </tr>
      </tbody></table>
    </td>
  </tr>
</tbody></table>
  </center>
</div>

&nbsp;

&nbsp;

<div align="center">
  <center>
<table width="900" border="0">
  <tbody><tr>
    <td width="100%" align="center">
    
<script type="text/javascript"><!--
google_ad_client = "pub-3968514660870014";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script type="text/javascript" src="propsheet_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px"><ins id="aswift_3_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px"><iframe allowtransparency="true" hspace="0" marginwidth="0" marginheight="0" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){i+='.call';setTimeout(h,0)}else if(h.match){i+='.nav';w.location.replace(h)}s.log&amp;&amp;s.log.push(i)}" vspace="0" id="aswift_3" name="aswift_3" style="left: 0pt; position: absolute; top: 0pt;" scrolling="no" width="728" frameborder="0" height="90"></iframe></ins></ins>

    </td>
  </tr>
</tbody></table>

  </center>
</div>

&nbsp;

<div align="center">
  <center>
<table width="900" border="0">
  <tbody><tr>
    <td colspan="3">
      <hr color="#FF0000">
    </td>
  </tr>
  <tr>
    <td align="center"><a href="http://www.functionx.com/visualc/index.htm">Home</a></td>
    <td align="center"><a href="http://www.functionx.com/visualc/index.htm">Copyright © 2010 FunctionX, Inc.</a></td>
    <td align="center">&nbsp;</td>
  </tr>
  <tr>
    <td colspan="3">
      <hr color="#FF0000">
    </td>
  </tr>
</tbody></table>
  </center>
</div>

<!-- DynamiContext AdLinks  -->
<script language="JavaScript">
var dc_UnitID = 14;
var dc_PublisherID = 2409;
var dc_AdLinkColor = 'blue';
var  dc_adprod='ADL';
</script>
<script language="JavaScript" src="propsheet_files/KonaLibInline.js"></script><script language="JavaScript" src="propsheet_files/KonaFlashBase.js"></script><a href="#" target="_top" id="AdLinkLayerClick"></a>
<span id="konasapn0"><script type="text/javascript" src="propsheet_files/KonaGet.txt"></script></span>

<!-- DynamiContext AdLinks  -->




</body></html>